# Description: Firefox binary
# URL: http://www.mozilla.com
# Maintainer: Fredrik Rinnestam, fredrik at crux dot guru
# Depends on: gtk3 dbus-glib

name=firefox-bin
version=64.0.2
release=1
source=(http://ftp.mozilla.org/pub/firefox/releases/$version/linux-x86_64/en-US/firefox-$version.tar.bz2 \
	policies.json)

build() {
	cd firefox
	install -d $PKG/usr/{lib,bin}
	mv $SRC/firefox $PKG/usr/lib/firefox
	ln -s /usr/lib/firefox/firefox $PKG/usr/bin/firefox
	mkdir -p $PKG/usr/lib/firefox/lib
	find $PKG/usr/lib/firefox -name '*.so' -exec cp '{}' lib/ \;

	mkdir -p $PKG/etc/revdep.d
	echo "/usr/lib/firefox" > $PKG/etc/revdep.d/firefox-bin

	#We don't want these 'features'
	rm -r $PKG/usr/lib/firefox/browser/features
	# Disable autoupdate
	mkdir $PKG/usr/lib/firefox/distribution

	install -m644 $SRC/policies.json $PKG/usr/lib/firefox/distribution/
}
